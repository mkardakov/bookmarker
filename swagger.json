{
    "swagger": "2.0",
    "info": {
        "title": "Bookmarker API",
        "description": "RESTful API developed for e-books sharing and management",
        "contact": {
            "name": "Mikhail K",
            "url": "https://github.com/mkardakov",
            "email": "work.zjiodeu@gmail.com"
        },
        "license": {
            "name": "MIT",
            "url": "http://github.com/gruntjs/grunt/blob/master/LICENSE-MIT"
        },
        "version": "0.01"
    },
    "host": "localhost:82",
    "basePath": "/",
    "schemes": [
        "http"
    ],
    "consumes": [
        "application/json"
    ],
    "produces": [
        "application/json"
    ],
    "paths": {
        "/author/{id}": {
            "get": {
                "summary": "Retrieve an author by id",
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "ID of author to fetch",
                        "required": true,
                        "type": "integer",
                        "format": "int64"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "author data",
                        "schema": {
                            "$ref": "#/definitions/Author"
                        }
                    },
                    "404": {
                        "description": "Author not found by id"
                    }
                }
            },
            "put": {
                "summary": "Updates an author",
                "operationId": "replace",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "ID of the author that needs to be update",
                        "required": true,
                        "type": "integer",
                        "format": "int64",
                        "minimum": 1
                    },
                    {
                        "name": "body",
                        "in": "body",
                        "description": "Author object that needs to be updated",
                        "required": true,
                        "schema": {
                            "properties": {
                                "name": {
                                    "type": "string"
                                },
                                "surname": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                ],
                "responses": {
                    "400": {
                        "description": "Invalid Data received"
                    },
                    "404": {
                        "description": "Author not found by id"
                    },
                    "200": {
                        "description": "success"
                    }
                }
            },
            "delete": {
                "summary": "Delete author by ID",
                "operationId": "remove",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "ID of the author that needs to be deleted",
                        "required": true,
                        "type": "integer",
                        "format": "int64",
                        "minimum": 1
                    }
                ],
                "responses": {
                    "400": {
                        "description": "Invalid ID supplied"
                    },
                    "404": {
                        "description": "Genre not found"
                    },
                    "200": {
                        "description": "success"
                    }
                }
            }
        },
        "/author": {
            "get": {
                "summary": "Retrieve all authors",
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "name": "max_record_number",
                        "in": "query",
                        "description": "limitation param",
                        "required": false,
                        "type": "integer"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "authors set",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/Author"
                            }
                        }
                    }
                }
            },
            "post": {
                "summary": "Creates a new author",
                "operationId": "add",
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "name": "body",
                        "in": "body",
                        "description": "Author object that needs to be added to the system",
                        "required": true,
                        "schema": {
                            "properties": {
                                "name": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                ],
                "responses": {
                    "201": {
                        "description": "author is added successfully",
                        "schema": {
                            "type": "object",
                            "additionalProperties": {
                                "contentUri": "string"
                            }
                        }
                    },
                    "400": {
                        "description": "bad request"
                    }
                }
            }
        },
        "/book/{id}": {
            "get": {
                "summary": "Retrieve a book by id",
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "ID of book to fetch",
                        "required": true,
                        "type": "integer",
                        "format": "int64"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "book data",
                        "schema": {
                            "$ref": "#/definitions/Book"
                        }
                    },
                    "404": {
                        "description": "Book not found by id"
                    }
                }
            },
            "put": {
                "summary": "Update an existiting book",
                "description": "",
                "operationId": "replaceBook",
                "consumes": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "ID of the book that needs to be update",
                        "required": true,
                        "type": "integer",
                        "format": "int64",
                        "minimum": 1
                    },
                    {
                        "name": "body",
                        "in": "body",
                        "description": "Book object that needs to be added to the store",
                        "required": true,
                        "schema": {
                            "properties": {
                                "title": {
                                    "type": "string"
                                },
                                "year": {
                                    "type": "string"
                                },
                                "lang": {
                                    "type": "string"
                                },
                                "genre_id": {
                                    "type": "integer",
                                    "minimum": 1
                                },
                                "author_ids": {
                                    "type": "array",
                                    "items": {
                                        "type": "integer",
                                        "minimum": 1
                                    }
                                }
                            }
                        },
                        "minimum": 1
                    }
                ],
                "responses": {
                    "400": {
                        "description": "Invalid Data received"
                    },
                    "404": {
                        "description": "Book not found by id"
                    },
                    "200": {
                        "description": "success"
                    }
                }
            },
            "delete": {
                "summary": "Delete book by ID",
                "operationId": "remove",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "ID of the book that needs to be deleted",
                        "required": true,
                        "type": "integer",
                        "format": "int64",
                        "minimum": 1
                    }
                ],
                "responses": {
                    "400": {
                        "description": "Invalid ID supplied"
                    },
                    "404": {
                        "description": "Book not found"
                    },
                    "200": {
                        "description": "success"
                    }
                }
            }
        },
        "/book": {
            "get": {
                "summary": "Retrieve all books",
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "name": "max_record_number",
                        "in": "query",
                        "description": "limitation param",
                        "required": false,
                        "type": "integer"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "books set",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/Book"
                            }
                        }
                    }
                }
            },
            "post": {
                "summary": "Creates a new book based on received file",
                "operationId": "addBook",
                "consumes": [
                    "multipart/form-data"
                ],
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "name": "book",
                        "in": "formData",
                        "description": "book to upload",
                        "required": true,
                        "type": "file"
                    }
                ],
                "responses": {
                    "201": {
                        "description": "book is uploaded successfully",
                        "schema": {
                            "type": "object",
                            "additionalProperties": {
                                "contentUri": "string"
                            }
                        }
                    },
                    "400": {
                        "description": "bad request"
                    }
                }
            }
        },
        "/book/{filename}": {
            "get": {
                "summary": "Show or Download book",
                "parameters": [
                    {
                        "name": "filename",
                        "in": "path",
                        "description": "name of the book to download",
                        "required": true,
                        "type": "string",
                        "format": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "book data",
                        "schema": {
                            "type": "file"
                        }
                    },
                    "400": {
                        "description": "bad request"
                    },
                    "404": {
                        "description": "Book file not found"
                    }
                }
            }
        },
        "/book/{id}/covers": {
            "get": {
                "summary": "Retrieve all book covers for particular book",
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "ID of the target book",
                        "required": true,
                        "type": "integer",
                        "format": "int64",
                        "minimum": 1
                    }
                ],
                "responses": {
                    "200": {
                        "description": "book covers set",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/BookCover"
                            }
                        }
                    },
                    "404": {
                        "description": "Book not found"
                    }
                }
            },
            "post": {
                "summary": "Creates a new book cover based on received file",
                "operationId": "addBookCover",
                "consumes": [
                    "multipart/form-data"
                ],
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "ID of the target book",
                        "required": true,
                        "type": "integer",
                        "format": "int64",
                        "minimum": 1
                    },
                    {
                        "name": "cover",
                        "in": "formData",
                        "description": "book to upload",
                        "required": true,
                        "type": "file"
                    }
                ],
                "responses": {
                    "201": {
                        "description": "book is uploaded successfully",
                        "schema": {
                            "type": "object",
                            "additionalProperties": {
                                "contentUri": "string"
                            }
                        }
                    },
                    "404": {
                        "description": "Book not found"
                    },
                    "400": {
                        "description": "bad request"
                    }
                }
            }
        },
        "/book/{id}/covers/{filename}": {
            "get": {
                "summary": "Show or Download book cover",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "ID of the target book",
                        "required": true,
                        "type": "integer",
                        "format": "int64",
                        "minimum": 1
                    },
                    {
                        "name": "filename",
                        "in": "path",
                        "description": "name of the book cover to download",
                        "required": true,
                        "type": "string",
                        "format": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "book cover file",
                        "schema": {
                            "type": "file"
                        }
                    },
                    "400": {
                        "description": "bad request"
                    },
                    "404": {
                        "description": "Book cover not found"
                    }
                }
            }
        },
        "/book/{id}/covers/{cover_id}": {
            "put": {
                "summary": "Update an existiting book cover meta-data",
                "operationId": "replaceBookCover",
                "consumes": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "ID of the target book",
                        "required": true,
                        "type": "integer",
                        "format": "int64",
                        "minimum": 1
                    },
                    {
                        "name": "cover_id",
                        "in": "path",
                        "description": "ID of the target book cover",
                        "required": true,
                        "type": "integer",
                        "format": "int64",
                        "minimum": 1
                    },
                    {
                        "name": "body",
                        "in": "body",
                        "description": "Book object that needs to be added to the store",
                        "required": true,
                        "schema": {
                            "properties": {
                                "is_main": {
                                    "type": "boolean"
                                }
                            }
                        },
                        "minimum": 1
                    }
                ],
                "responses": {
                    "400": {
                        "description": "Invalid Data received"
                    },
                    "404": {
                        "description": "Book or Book cover not found by id"
                    },
                    "200": {
                        "description": "success"
                    }
                }
            },
            "delete": {
                "summary": "Delete book cover by ID",
                "operationId": "removeCover",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "ID of the book that needs to be deleted",
                        "required": true,
                        "type": "integer",
                        "format": "int64",
                        "minimum": 1
                    },
                    {
                        "name": "cover_id",
                        "in": "path",
                        "description": "ID of the target book cover",
                        "required": true,
                        "type": "integer",
                        "format": "int64",
                        "minimum": 1
                    }
                ],
                "responses": {
                    "400": {
                        "description": "Invalid ID supplied"
                    },
                    "404": {
                        "description": "Book or Book cover not found"
                    },
                    "200": {
                        "description": "success"
                    }
                }
            }
        },
        "/book/{id}/votes": {
            "get": {
                "summary": "Compute rating of book based on user votes",
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "ID of book to fetch",
                        "required": true,
                        "type": "integer",
                        "format": "int64"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "vote scalar value",
                        "schema": {
                            "type": "float"
                        }
                    },
                    "400": {
                        "description": "Invalid ID supplied"
                    },
                    "404": {
                        "description": "Book or Book cover not found"
                    }
                }
            },
            "delete": {
                "summary": "Delete user`s vote only",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "ID of the book that needs to be deleted",
                        "required": true,
                        "type": "integer",
                        "format": "int64",
                        "minimum": 1
                    }
                ],
                "responses": {
                    "400": {
                        "description": "Invalid ID supplied"
                    },
                    "404": {
                        "description": "Book not found"
                    },
                    "200": {
                        "description": "success"
                    }
                }
            }
        },
        "/genre": {
            "get": {
                "summary": "Retrieve all genres",
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "name": "max_record_number",
                        "in": "query",
                        "description": "limitation param",
                        "required": false,
                        "type": "integer"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "genres set",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/Genre"
                            }
                        }
                    }
                }
            },
            "post": {
                "summary": "Creates a new genre",
                "operationId": "add",
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "name": "body",
                        "in": "body",
                        "description": "Genre object that needs to be added to the system",
                        "required": true,
                        "schema": {
                            "properties": {
                                "title": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                ],
                "responses": {
                    "201": {
                        "description": "genre is created successfully",
                        "schema": {
                            "type": "object",
                            "additionalProperties": {
                                "contentUri": "string"
                            }
                        }
                    },
                    "400": {
                        "description": "bad request"
                    }
                }
            }
        },
        "/genre/{id}": {
            "get": {
                "summary": "Retrieve a genre by id",
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "ID of genre to fetch",
                        "required": true,
                        "type": "integer",
                        "format": "int64"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "genre data",
                        "schema": {
                            "$ref": "#/definitions/Genre"
                        }
                    },
                    "404": {
                        "description": "Genre not found by id"
                    }
                }
            },
            "put": {
                "summary": "Updates a genre",
                "operationId": "replace",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "ID of the genre that needs to be update",
                        "required": true,
                        "type": "integer",
                        "format": "int64",
                        "minimum": 1
                    },
                    {
                        "name": "body",
                        "in": "body",
                        "description": "Genre object that needs to be updated",
                        "required": true,
                        "schema": {
                            "properties": {
                                "title": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                ],
                "responses": {
                    "400": {
                        "description": "Invalid Data received"
                    },
                    "404": {
                        "description": "Genre not found by id"
                    },
                    "200": {
                        "description": "success"
                    }
                }
            },
            "delete": {
                "summary": "Delete genre by ID",
                "operationId": "remove",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "ID of the genre that needs to be deleted",
                        "required": true,
                        "type": "integer",
                        "format": "int64",
                        "minimum": 1
                    }
                ],
                "responses": {
                    "400": {
                        "description": "Invalid ID supplied"
                    },
                    "404": {
                        "description": "Genre not found"
                    },
                    "200": {
                        "description": "success"
                    }
                }
            }
        },
        "/user/{id}": {
            "get": {
                "summary": "Retrieve a user by id",
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "ID of user to fetch",
                        "required": true,
                        "type": "integer",
                        "format": "int64"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "user info",
                        "schema": {
                            "$ref": "#/definitions/User"
                        }
                    },
                    "404": {
                        "description": "User not found by id"
                    }
                }
            },
            "put": {
                "summary": "Updates a user",
                "operationId": "replace",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "ID of the user that needs to be update",
                        "required": true,
                        "type": "integer",
                        "format": "int64",
                        "minimum": 1
                    },
                    {
                        "name": "body",
                        "in": "body",
                        "description": "User object that needs to be updated",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/User"
                        }
                    }
                ],
                "responses": {
                    "400": {
                        "description": "Invalid Data received"
                    },
                    "404": {
                        "description": "User not found by id"
                    },
                    "200": {
                        "description": "success"
                    }
                }
            },
            "delete": {
                "summary": "Delete user by ID",
                "operationId": "remove",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "ID of the user that needs to be deleted",
                        "required": true,
                        "type": "integer",
                        "format": "int64",
                        "minimum": 1
                    }
                ],
                "responses": {
                    "400": {
                        "description": "Invalid ID supplied"
                    },
                    "404": {
                        "description": "User not found"
                    },
                    "200": {
                        "description": "success"
                    }
                }
            }
        },
        "/user": {
            "get": {
                "summary": "Retrieve all users",
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "name": "max_record_number",
                        "in": "query",
                        "description": "limitation param",
                        "required": false,
                        "type": "integer"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "users set",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/Users"
                            }
                        }
                    }
                }
            },
            "post": {
                "summary": "Creates a new user",
                "operationId": "add",
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "name": "body",
                        "in": "body",
                        "description": "User object that needs to be added to the system",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/User"
                        }
                    }
                ],
                "responses": {
                    "201": {
                        "description": "user was created",
                        "schema": {
                            "type": "object",
                            "additionalProperties": {
                                "contentUri": "string"
                            }
                        }
                    },
                    "400": {
                        "description": "bad request"
                    }
                }
            }
        }
    },
    "definitions": {
        "Author": {
            "properties": {
                "id": {
                    "type": "integer"
                },
                "name": {
                    "type": "string"
                },
                "surname": {
                    "type": "string"
                }
            },
            "type": "object"
        },
        "Book": {
            "properties": {
                "id": {
                    "type": "integer"
                },
                "ext": {
                    "type": "string"
                },
                "filePath": {
                    "type": "string"
                },
                "title": {
                    "type": "string"
                },
                "year": {
                    "type": "integer"
                },
                "lang": {
                    "type": "string"
                },
                "authors": {
                    "type": "string"
                },
                "genre": {
                    "type": "string"
                },
                "mime": {
                    "type": "string"
                },
                "user": {
                    "$ref": "#/definitions/User"
                },
                "bookCovers": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/BookCover"
                    }
                },
                "description": {
                    "type": "string"
                }
            },
            "type": "object"
        },
        "BookCover": {
            "properties": {
                "id": {
                    "type": "integer"
                },
                "imagePath": {
                    "type": "string"
                },
                "isMain": {
                    "type": "boolean"
                }
            },
            "type": "object"
        },
        "Genre": {
            "properties": {
                "id": {
                    "type": "integer"
                },
                "title": {
                    "type": "string"
                }
            },
            "type": "object"
        },
        "Role": {
            "properties": {
                "id": {
                    "type": "string"
                },
                "title": {
                    "type": "string"
                }
            },
            "type": "object"
        },
        "User": {
            "properties": {
                "id": {
                    "type": "integer"
                },
                "password": {
                    "type": "string"
                },
                "name": {
                    "type": "string"
                },
                "surname": {
                    "type": "string"
                },
                "email": {
                    "type": "string"
                },
                "roles": {
                    "type": "string"
                }
            },
            "type": "object"
        }
    },
    "securityDefinitions": {
        "Basic authorization by login:password": {
            "type": "basic"
        }
    }
}